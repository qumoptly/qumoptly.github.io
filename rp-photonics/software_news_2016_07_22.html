<!DOCTYPE html>
<html lang="en">

<!-- Mirrored from www.rp-photonics.com/software_news_2016_07_22.html by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 12 Feb 2019 03:09:42 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
<meta http-equiv="content-type" content="text/html; charset=utf-8">
<title>Software from RP Photonics - Ultrashort Pulse Simulations with the RP Fiber Power Software</title>
<link rel="stylesheet" type="text/css" href="styles.css">
<link rel="stylesheet" type="text/css" href="shariff/shariff.complete.css">
<link rel="shortcut icon" href="favicon.ico" type="image/x-icon">
<link rel="alternate" type="application/rss+xml" title="The Photonics Spotlight" href="spotlight.rss">
<link rel="alternate" type="application/rss+xml" title="The RP Photonics Software News" href="software_news.rss">
<link rel="alternate" type="application/rss+xml" title="New encyclopedia articles" href="new_articles.rss">
<meta name="date" content="2016-07-22">
<meta name="description" content="A summary of this blog article: It is shown how the propagation of ultrashort pulses e.g. in mode-locked fiber lasers, bulk lasers, regenerative amplifiers and fiber amplifiers can be numerically simulated - specifically, with the software RP Fiber Power from RP Photonics. The used concept, involving function calls rather than commands for sending the pulse through various optical components, turns out to be extremely flexible, allowing the user to implement quite sophisticated simulations.">
<meta name="copyright" content="2019 RP Photonics Consulting GmbH">
<meta name="author" content="Dr. R&uuml;diger Paschotta">
<meta name="publisher" content="RP Photonics Consulting GmbH">
<meta name="referrer" content="always">
<meta name="geo.position" content="48.018; 8.540">
<meta name="geo.placename" content="Bad D&uuml;rrheim">
<meta name="geo.region" content="DE">
<meta name="distribution" content="global">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="keywords" content="photonics, modeling, software, optics, lasers, simulations, analysis, optimization, news, newsletter">
<script type="text/javascript" src="jquery-3.3.1.min.js"></script>
<script type="text/javascript" src="general.js"></script>
<script type="text/javascript">
page="software_news_2016_07_22.html"; cat="S"; shownbanner=""; ref="encyclopedia_p.html"; ts = new Date().toJSON().substring(0, 19);
$(document).ready(function($){ $.get("log.html",{cat:cat,page:page,ref:ref,shownbanner:shownbanner,ts:ts}); })
</script>
</head>
<body>
<div id="logohead">
<div class="areadiv"><table id="areatable"><tr><td>
<div class="areadiv"><table class="areasubtable">
<tr><td colspan="2" class="basicarea"><a href="marketing.html">RP Photonics Marketing</a></td></tr>
<tr><td><a href="encyclopedia.html">Encyclopedia</a></td>
<td><a href="buyersguide.html">Buyer's Guide</a></td></tr>
</table></div>
</td>
<td>
<div class="areadiv"><table class="areasubtable">
<tr><td colspan="2" class="basicarea"><a href="consulting.html">RP Services and Tools</a></td></tr>
<tr><td><a href="consulting.html">Consulting</a></td>
<td class="selected"><a href="software.html">Software</a></td></tr>
</table></div>
</td></tr></table></div>
<p><span id="title1">RP Photonics</span></p>
<p><span id="title2">Software</span> <span id="slogan">&hellip; powerful tools for your research &amp; development!</span></p>
</div>
<nav id="soft">
<div id="navitems">
<a id="Software" href="software.html">Overview</a>
<a id="Modeling" href="software_modeling.html">Modeling</a>
<a id="rp_fiber_calculator" href="rp_fiber_calculator.html">RP Fiber Calculator</a>
<a id="rp_fiberpower" href="fiberpower.html">RP Fiber Power</a>
<a id="rp_resonator" href="resonator.html">RP Resonator</a>
<a id="rp_propulse" href="propulse.html">RP ProPulse</a>
<a id="rp_coating" href="coating.html">RP Coating</a>
<a id="rp_q_switch" href="rp_q_switch.html">RP Q-switch</a>
<a id="script_language" href="software_script_language.html">Script language</a>
<a id="debugger" href="software_debugger.html">Debugger</a>
<a id="custom_forms" href="software_custom_forms.html">Custom forms</a>
<a id="licenses" href="software_licenses.html">Licenses</a>
<a id="documentation" href="software_docu.html">Documentation</a>
<a id="support" href="software_support.html">Support</a>
<a id="distributors" href="software_distributors.html">Distributors</a>
<a id="software_news" href="software_news.html" class="sel">Software News</a>
<a id="contact" href="software_contact.html">*Get a quotation*</a>
</div>
</nav>
<div id="main" style="margin-top:20px;">
<main>
<h1 class="spotlight_heading">The RP Photonics Software News</h1>
<h1 class="posting">Ultrashort Pulse Simulations with the RP Fiber Power Software</h1>
<div class="posting_details">
<p>Posted on 2016-07-22 in the <a href="software_news.html">RP Photonics Software News (available as e-mail newsletter!)</a>
<p>Permanent link: <a href="software_news_2016_07_22.html">https://www.rp-photonics.com/software_news_2016_07_22.html</a></p>
<p>Author: <a href="paschotta.html">Dr. Rüdiger Paschotta</a>, <a href="index.html">RP Photonics Consulting GmbH</a></p>
<p>Abstract: It is shown how the propagation of ultrashort pulses e.g. in mode-locked fiber lasers, bulk lasers, regenerative amplifiers and fiber amplifiers can be numerically simulated - specifically, with the software RP Fiber Power from RP Photonics. The used concept, involving function calls rather than commands for sending the pulse through various optical components, turns out to be extremely flexible, allowing the user to implement quite sophisticated simulations.</p>
</div>
<figure class="right" style="width:130px;">
<img src="img/paschotta5.jpg" alt="Dr. Rüdiger Paschotta">
</figure>
<p>Since V4, our software <a href="fiberpower.html"><b>RP Fiber Power</b></a> can be used for simulating the propagation of <a href="ultrashort_pulses.html" title="ultrashort pulses: optical pulses with durations of picoseconds or less">ultrashort pulses</a>.
I thought that it might be useful for many to learn how that works &ndash; whether you already have the software or you consider to get it for your research and development.
By the way, in recent weeks I have introduced substantial software improvements in that area.
If you use such features already, tell us to send you a free update.</p>
<p>Let me emphasize that these features are <em>not</em> limited to pulse propagation in optical fibers &ndash; you will see later on how to take into account various other optical elements as well.
So if you are working on mode-locked <a href="bulk_lasers.html" title="bulk lasers: lasers based on bulk crystals as gain media">bulk lasers</a> or <a href="regenerative_amplifiers.html" title="regenerative amplifiers: optical amplifiers with a resonator in which a light pulse can do multiple round trips before being coupled out">regenerative amplifiers</a>, for example, be assured that the same software can be applied to that just as well.
Only for synchronously pumped <a href="optical_parametric_oscillators.html" title="optical parametric oscillators: coherent light sources based on parametric amplification within an optical resonator">optical parametric oscillators</a> and <a href="optical_parametric_amplifiers.html" title="optical parametric amplifiers: optical amplifiers based on parametric nonlinear interactions">amplifiers</a> the software is not usable so far.</p>
<p>This article should also be useful for those who intend to develop such simulations themselves, using Matlab or some other programming environment.
There, however, the challenge would be to implement all the details of the interaction of ultrashort pulses with optical components.
That is quite simple for some elements, but a rather sophisticated matter for others such as optical fibers, perhaps even active fibers.
While you may learn a lot when doing that, you will surely spend an awful lot of time.
Using a software which provides such functions, you can focus on the physics and technology and get the required results much faster.
Essentially, the question is whether you want to start a big learning exercise or other need to produce results quickly.
By the way, you will also learn a lot about the physics when using such software.</p>
<h2 class="togglediv">The Concept</h2>
<div>
<p>The essential concept for simulating ultrashort pulse propagation in <b>RP Fiber Power</b> differs from that of our earlier product <a href="propulse.html"><b>RP ProPulse</b></a>.
We do <em>not</em> first describe our optical system &ndash; the racetrack through which we later on want to send our pulses &ndash; to the software.
Instead, we use certain functions of the <a href="software_script_language.html">script language</a> for defining or loading an initial pulse and later on for sending that pulse through optical elements.
Additional functions can be used for retrieving all sorts of properties of the &ldquo;current pulse&rdquo;, meaning the pulse as it is at the moment (after having seen certain elements).</p>
<p>The advantage of that approach is that it is most flexible.
The mentioned functions can be used within any expressions, and we can make use of the powerful control structures available for such expressions: if-then statements, while-do loops, for loops, repeat-until and the like.
You can use such expressions in many ways &ndash; for example, for various initializations, but also during the generation of any graphical diagram.
Such flexibility turns out to be essential for any real research or development work.</p>
</div>
<h2 class="togglediv">Example: Mode-locked Fiber Laser</h2>
<div>
<p>In most cases, what is of main interest is what pulses you get in the steady state of the mode-locked laser.
Usually, one cannot directly calculate that steady state, since it results from complicated interactions involving optical gain and losses (possibly wavelength-dependent), chromatic dispersion, fiber nonlinearities, saturable absorption, etc.
Therefore, in most cases one just simulates the evolution of some initial pulse within some number of resonator round trips, hoping that the system will closely reach the steady state within a reasonable number of round trips.
Well, there are cases where there is no such steady state; there are unstable lasers, the study of which can of course also be scientifically interesting.
In some cases, one also likes to study the details of the start-up process, but let us now focus on the steady state.</p>
<p>The details of the initial pulse are usually not critical; you just don't want to be far away from the steady state in order to reach that quickly.
You would just roughly guess parameters like pulse energy and duration, and generate a Gaussian unchirped start pulse, for example:</p>
<pre class="codedisplay">
; Parameters:
l_s := 1060 nm  { center wavelength }
T_range := 25 ps  { width of temporal range }
N_t := 2^10  { number of grid points }
dt := T_range / N_t  { temporal resolution }
E0 := 10 nJ  { initial pulse energy }
tau0 := 1 ps  { initial pulse duration }
chirp0 := 0 GHz / ps  { initial chirp }
&nbsp;
calc  { evaluate the following composite expression }
  begin
  set_pulse_grid(T_range, N_t, l_s);  { define the pulse grid }
  startpulse_G(E0, tau0, chirp0);  { generate the start pulse }
  end
</pre>
<p>The pulse grid, essentially defined by the width of the temporal range, the number of numerical points and the center wavelength, must be large enough to well accommodate the pulse at all stages.
Also, the temporal resolution must be high enough to accommodate the full pulse bandwidth.
For many bulk laser simulations, 256 points are fully sufficient, but for strongly chirped pulses, as often occur in fiber lasers, 1024 points or even more can be necessary.
(For <a href="supercontinuum_generation.html" title="supercontinuum generation: a nonlinear process for strong spectral broadening of light">supercontinuum generation</a>, one may require even tens of thousands.)</p>
<p>At some point, you have to define the involved fibers.
Essentially, for each one you define a model as used for continuous-wave simulations, and in addition you assign some properties to it which are needed for ultrashort pulse propagation: essentially, the chromatic dispersion and the nonlinear index &ndash; in some cases, some more details concerning stimulated Raman scattering (not to be considered here).
The following is the used code, not including the definition of various parameters, for a model with an active and one passive fiber in a linear resonator:</p>
<pre class="codedisplay">
calc  { define the fibers }
  begin
    { active fiber: }
    set_device(1);
    set_fiber(L_active, 20, 'Yb');
    add_ring(r_co, N_Yb);
    pump := addinputchannel(P_pump_in, l_p, 'I_p', 0, forward);
    signal_active_fw := addinputchannel(0, l_s, 'I_s', 0, forward);
    signal_active_bw := addinputchannel(0, l_s, 'I_s', 0, backward);
    set_GVD(GVD_af);
    set_n2(n2_f);  { nonlinear index }
    finish_fiber();
    { passive fiber: }
    set_device(2);
    set_fiber(L_passive, 5, '-');
    signal_passive_fw := addinputchannel(0, l_s, 'I_s', 0, forward);
    signal_passive_bw := addinputchannel(0, l_s, 'I_s', 0, backward);
    set_GVD(GVD_pf);
    set_n2(n2_f);  { nonlinear index }
    finish_fiber();
  end;
</pre>
<p>The start pulse is usually assumed to be the intracavity pulse just before it hits the <a href="output_couplers.html" title="output couplers: partially transparent laser mirrors, used for extracting output beams from laser resonators">output coupler</a>.
So the output coupler, causing some losses, will be the first optical element seen in a resonator round trip.
After that, the circulating pulse may see the active fiber, one or more passive fibers, a saturable absorber and/or an optical modulator, and possibly other optical elements.
It is often convenient to define a function which performs a complete resonator round trip:</p>
<pre class="codedisplay">
DoResonatorRoundTrip() := 
  { Simulate one resonator round-trip of the pulse. }
  begin
    global allow all;
    pp_multiply_expr_f('r_FBG%(f)');  { fiber Bragg grating as output coupler }
    pp_fiber(1, signal_active_fw);  { active fiber }
    pp_fiber(2, signal_passive_fw);  { passive fiber }
    pp_sat_abs(dR_S, tau_S, E_sat_S);  { SESAM }
    pp_loss(loss_S);  { loss in SESAM }
    pp_fiber(2, signal_passive_bw);  { passive fiber }
    pp_fiber(1, signal_active_bw);  { active fiber }
    pp_center(1);  { center the pulse }
    calc_dyn(0, T_rt, T_rt);  { dynamical simulation of gain recovery }
  end
</pre>
<p>Note that our example is based on a linear resonator, where after reaching the other end (the SESM, a saturable absorber) we go all the way back to the initial position.
Of course, various parameters used in our function have to be defined elsewhere.</p>
<p>The last function call simulates the pumping of the fiber during one round-trip time, replenishing the stored energy.</p>
<p>Thereafter, it is easy to simulate some number of round trips and display some parameters of the intracavity pulse after those:</p>
<pre class="codedisplay">
calc
  for j := 1 to 1000 do
  begin
    DoResonatorRoundTrip();
    store_pulse(j);
  end
show "Energy:    ", E_p():d3:"J"
show "Duration:  ", tau_p():d3:"s"
show "Bandwidth: ", dl_p():d3:"m"
</pre>
<p>Here, we have also stored all the pulses, so that we can later recall them for additional calculations and for generating diagrams, and also we can inspect them with the <a href="fiberpower_interface.html#pulse_display">interactive pulse display window</a>.</p>
<p>There is actually a problem with the simple approach shown here: usually it takes a very large number of round trips until the fiber's gain has settled at the final level.
Essentially, there are <a href="relaxation_oscillations.html" title="relaxation oscillations: small mutually coupled oscillations of the laser power and laser gain around their steady-state values">relaxation oscillations</a> which disappear only after a huge number of round trips.
If you want to study those, it's just fine.
If you want to find a steady state quickly, however, you can apply some additional trick: with a few more lines of code (not shown here), you can in each round trip have the fiber's gain recalculated according to the pulse energy &ndash; just as if the gain could respond to that instantaneously.
That way, you can effectively suppress relaxation oscillations and get the final result much more quickly.
Another possibility would be to artificially increase the gain saturation by a large factor (e.g. 100) while decreasing the effective pulse repetition rate by the same factor; that would effectively accelerate the relaxation oscillations very strongly, hugely saving on computation time.
Of course, users of our software get my detailed advice on such tricks.</p>
<p>Another issue is that you may not be sure how many round trips are required for reaching the steady state.
Therefore, you may want to define a function which simulates such round trips until the essential pulse properties (energy, duration, bandwidth) do not change substantially anymore:</p>
<pre class="codedisplay">
FindSteadyState(tol, N_max) := 
  { Find the steady state,
    defined by the time where the relative changes
    of E_out and tau are less than tol for 3 successive steps.
    Return 1 if steady state is found within N_max steps,
    0 otherwise. }
  begin
    var n_sc, N, E1, E2, tau1, tau2, df1, df2;
    N := 0;  { no round trips }
    n_sc := 0;  { no round trips with small change of pulse parameters }
    E1 := E_p();  tau1 := tau_p();  df1 := df_p();
    repeat
      inc(N);
      DoResonatorRoundTrip();
      E2 := E_p();  tau2 := tau_p();  df2 := df_p();
      if abs(E2 / E1 - 1) &lt;= tol
         and abs(tau2 / tau1 - 1) &lt;= tol
         and abs(df2 / df1 - 1) &lt;= tol
      then inc(n_sc)
      else n_sc := 0;
      E1 := E2;  tau1 := tau2;  df1 := df2;
    until n_sc = 3 or N &gt;= N_max;
    (n_sc = 3);
  end
</pre>
<p>You can then call that function at any time to get the steady state calculated efficiently.
It will return 1 if it worked, or 0 in case that the steady state could not be found within the given maximum number of round trips.
You could easily modify the details of that strategy as required in your case.</p>
<p>I give you an example for the application of that function.
Let us assume that we want to generate a diagram where we want to plot the steady-state pulse energy and duration as functions of the pump power:</p>
<pre class="codedisplay">
"Variation of Pump Power"
&nbsp;
x: 400, 600
"pump power (mW)", @x
y: 0, 20
frame
&nbsp;
! for x := CS_x1 to CS_x2 step 20 do
  begin
    set_device(1);  { active fiber }
    set_P_in(pump, x * mW);
    if FindSteadyState(0.01, 1000) then
    begin
      point(x + i * E_p() / nJ, "R");  { filled rectangle for pulse energy in nJ }
      point(x + i * tau_p() / ps, "t");  { open triangle for pulse duration in ps }
    end;
  end
</pre>
</div>
<h2 class="togglediv">Other Scenarios</h2>
<div>
<p>The example above has shown you how one can implement a relatively sophisticated simulation with not too much code.
Here are some more example for possible scenarios:</p>
<ul>
<li>Consider an amplifier system fed by a continuous pulse train from a seed laser.
Again, you can simulate how the pulse energy evolves towards its steady state.
You could also study e.g. how it fluctuates if you have random time intervals between the pulses, or just some pulses missing, or a sequence of pulse bunches, or fluctuations of the pump power or of properties of the seed pulses, etc.</li>
<li>A <a href="regenerative_amplifiers.html" title="regenerative amplifiers: optical amplifiers with a resonator in which a light pulse can do multiple round trips before being coupled out">regenerative amplifier</a> works such that one sometimes injects a seed pulse, then lets it evolve over some number of round trips, and then ejects it.
After some time of pumping the amplifier crystal, one can perform the next amplification cycle.
Here, one can easily implement a function which simulates a complete amplification cycle with the given number of resonator round trips.
Again, one could use a function which simulates such amplification cycles until the steady state is reached.
Some systems exhibit bifurcations and even chaos &ndash; see some <a href="fiberpower_regen.html">online example case</a>.</li>
</ul>
</div>
<h2 class="togglediv">Other Optical Components</h2>
<div>
<p>In the example above, you have seen how to send a pulse through different optical fibers, and also how to apply optical components with some optical losses or some saturable absorption.
There are lots of other functions for applying other optical components:</p>
<ul>
<li>pp&lowbar;dispersion() for applying <a href="chromatic_dispersion.html" title="chromatic dispersion: the frequency dependence of the phase velocity in a transparent medium">chromatic dispersion</a> up to 4th order</li>
<li>pp&lowbar;multiply&lowbar;expr&lowbar;f() for multiplying the frequency-domain amplitudes of the pulse with a frequency-dependent factor &ndash; for example, for applying arbitrary dispersion (phase shifts) or a bandpass filter; similar things can be done in the time domain, e.g. for optical modulators</li>
<li>pp&lowbar;prism&lowbar;pair() and pp&lowbar;grating&lowbar;pair() for applying the chromatic dispersion from a prism pair or grating pair, respectively, with given parameters (such as spacing, lines per millimeter, etc.)</li>
<li>pp&lowbar;compress() for an automatically optimized dispersive compressor (up to 4th order)</li>
<li>pp&lowbar;noise() for adding some random noise</li>
<li>pp&lowbar;SPM() for an optical element with self-phase modulation</li>
<li>pp&lowbar;add&lowbar;pulse() for coherently adding a pulse, e.g. in simulations for interferometers or of <a href="additive_pulse_mode_locking.html" title="additive-pulse mode locking: a technique for mode locking a laser, using a nonlinear interaction in an external resonator">additive pulse mode locking</a></li>
</ul>
<p>These components allow you to simulate all common kinds of setups for the generation or manipulation of ultrashort pulses, only (so far) not with parametric nonlinear gain.</p>
<p>All that has been developed with great care.
To give you an example, I realized that functions like pp&lowbar;multiply&lowbar;expr&lowbar;f() and pp&lowbar;prism&lowbar;pair() are often applied many times with the same parameters.
I therefore implemented those such that the frequency-dependent factors, as obtained to the frequency-domain pulse amplitudes, are stored and can be reused in a later function call.
That works even if multiple parameter sets are used in a simulation.
Due to such tricks, which the user does not even have to think about, the performance of such computations can be very high.</p>
<p>I hope you have seen that it can be great fun to have such a powerful tool.
A researcher can use it to relatively quickly develop rather sophisticated studies, and in industry you can rapidly analyze the behavior of systems in order to optimize them or understand certain peculiarities.
The alternative would be working in blind flight mode &ndash; not very efficient in practice &hellip;</p>
<p>Of course, ultrashort pulse simulations are not a trivial thing, involving a lot of physics and also a lot of important practical aspects.
Therefore, it is essential not only to have some good piece of software, but also to obtain powerful <a href="software_support.html">technical support</a>.
I deliver that personally, making sure that people can make rapid progress, and that way I regularly have very happy customers.</p>
</div>
<p style="font-size:85%; margin-bottom:10px;">This article is a posting of the <a href="software_news.html">RP Photonics Software News</a>, authored by <a href="paschotta.html">Dr. Rüdiger Paschotta</a>.
You may link to this page, because its location is permanent.</p>
<p style="font-size:85%; margin-bottom:15px;">Note that you can also receive the articles in the form of a <a href="newsletters.html">newsletter</a> or with an <a href="software_news.rss">RSS feed</a>.</p>
<p style="margin-top:15px;">If you like this article, share it with your friends and colleagues, e.g. via social media:</p>
<div class="shariff" data-services="[&quot;linkedin&quot;,&quot;facebook&quot;,&quot;twitter&quot;,&quot;googleplus&quot;]" data-theme="standard" data-lang="en" data-orientation="horizontal"></div>
<script type="text/javascript" src="shariff/shariff.min.js"></script>
</main>
<div id="up_arrow">
<a href="javascript:scroll(0,0)"><img src="img/up.png" width="32" height="20" alt="arrow"></a>
</div>

</div>
<footer id="copyrightbox">
<span class="copyright">&copy; <a href="paschotta.html">Dr. Rüdiger Paschotta</a>, RP Photonics Consulting GmbH, also at <a href="https://profiles.google.com/109063044353551581702?rel=author">Google+</a>&nbsp;&nbsp;&nbsp;&nbsp; All rights reserved worldwide</span>
</footer>
</body>

<!-- Mirrored from www.rp-photonics.com/software_news_2016_07_22.html by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 12 Feb 2019 03:09:42 GMT -->
</html>
