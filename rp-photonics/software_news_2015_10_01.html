<!DOCTYPE html>
<html lang="en">

<!-- Mirrored from www.rp-photonics.com/software_news_2015_10_01.html by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 12 Feb 2019 03:10:11 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
<meta http-equiv="content-type" content="text/html; charset=utf-8">
<title>Software from RP Photonics - Making Plots With a Variation of Operation or System Parameters</title>
<link rel="stylesheet" type="text/css" href="styles.css">
<link rel="stylesheet" type="text/css" href="shariff/shariff.complete.css">
<link rel="shortcut icon" href="favicon.ico" type="image/x-icon">
<link rel="alternate" type="application/rss+xml" title="The Photonics Spotlight" href="spotlight.rss">
<link rel="alternate" type="application/rss+xml" title="The RP Photonics Software News" href="software_news.rss">
<link rel="alternate" type="application/rss+xml" title="New encyclopedia articles" href="new_articles.rss">
<meta name="date" content="2015-10-01">
<meta name="description" content="A summary of this blog article: This article gives you a lot of useful hints for preparing plots with our software. Along the x axis of a diagram, you can vary any operation or system parameter. It is not difficult even to implement additional options, such as to automatically adjust an input power so as to obtain a certain output power.">
<meta name="copyright" content="2019 RP Photonics Consulting GmbH">
<meta name="author" content="Dr. R&uuml;diger Paschotta">
<meta name="publisher" content="RP Photonics Consulting GmbH">
<meta name="referrer" content="always">
<meta name="geo.position" content="48.018; 8.540">
<meta name="geo.placename" content="Bad D&uuml;rrheim">
<meta name="geo.region" content="DE">
<meta name="distribution" content="global">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="keywords" content="photonics, modeling, software, optics, lasers, simulations, analysis, optimization, news, newsletter">
<script type="text/javascript" src="jquery-3.3.1.min.js"></script>
<script type="text/javascript" src="general.js"></script>
<script type="text/javascript">
page="software_news_2015_10_01.html"; cat="S"; shownbanner=""; ref="software_news.html"; ts = new Date().toJSON().substring(0, 19);
$(document).ready(function($){ $.get("log.html",{cat:cat,page:page,ref:ref,shownbanner:shownbanner,ts:ts}); })
</script>
</head>
<body>
<div id="logohead">
<div class="areadiv"><table id="areatable"><tr><td>
<div class="areadiv"><table class="areasubtable">
<tr><td colspan="2" class="basicarea"><a href="marketing.html">RP Photonics Marketing</a></td></tr>
<tr><td><a href="encyclopedia.html">Encyclopedia</a></td>
<td><a href="buyersguide.html">Buyer's Guide</a></td></tr>
</table></div>
</td>
<td>
<div class="areadiv"><table class="areasubtable">
<tr><td colspan="2" class="basicarea"><a href="consulting.html">RP Services and Tools</a></td></tr>
<tr><td><a href="consulting.html">Consulting</a></td>
<td class="selected"><a href="software.html">Software</a></td></tr>
</table></div>
</td></tr></table></div>
<p><span id="title1">RP Photonics</span></p>
<p><span id="title2">Software</span> <span id="slogan">&hellip; powerful tools for your research &amp; development!</span></p>
</div>
<nav id="soft">
<div id="navitems">
<a id="Software" href="software.html">Overview</a>
<a id="Modeling" href="software_modeling.html">Modeling</a>
<a id="rp_fiber_calculator" href="rp_fiber_calculator.html">RP Fiber Calculator</a>
<a id="rp_fiberpower" href="fiberpower.html">RP Fiber Power</a>
<a id="rp_resonator" href="resonator.html">RP Resonator</a>
<a id="rp_propulse" href="propulse.html">RP ProPulse</a>
<a id="rp_coating" href="coating.html">RP Coating</a>
<a id="rp_q_switch" href="rp_q_switch.html">RP Q-switch</a>
<a id="script_language" href="software_script_language.html">Script language</a>
<a id="debugger" href="software_debugger.html">Debugger</a>
<a id="custom_forms" href="software_custom_forms.html">Custom forms</a>
<a id="licenses" href="software_licenses.html">Licenses</a>
<a id="documentation" href="software_docu.html">Documentation</a>
<a id="support" href="software_support.html">Support</a>
<a id="distributors" href="software_distributors.html">Distributors</a>
<a id="software_news" href="software_news.html" class="sel">Software News</a>
<a id="contact" href="software_contact.html">*Get a quotation*</a>
</div>
</nav>
<div id="main" style="margin-top:20px;">
<main>
<h1 class="spotlight_heading">The RP Photonics Software News</h1>
<h1 class="posting">Making Plots With a Variation of Operation or System Parameters</h1>
<div class="posting_details">
<p>Posted on 2015-10-01 in the <a href="software_news.html">RP Photonics Software News (available as e-mail newsletter!)</a>
<p>Permanent link: <a href="software_news_2015_10_01.html">https://www.rp-photonics.com/software_news_2015_10_01.html</a></p>
<p>Author: <a href="paschotta.html">Dr. Rüdiger Paschotta</a>, <a href="index.html">RP Photonics Consulting GmbH</a></p>
<p>Abstract: This article gives you a lot of useful hints for preparing plots with our software. Along the x axis of a diagram, you can vary any operation or system parameter. It is not difficult even to implement additional options, such as to automatically adjust an input power so as to obtain a certain output power.</p>
</div>
<figure class="right" style="width:130px;">
<img src="img/paschotta5.jpg" alt="Dr. Rüdiger Paschotta">
</figure>
<p>The powerful <a href="software_script_language.html">script language</a>, which is supported by most of our software products, allows our users to generate all sorts of plots &ndash; not just some predefined ones.
Here, I would like to give some useful hints for beginners, which could also be of interest for those considering to start with our software.
You will see that a lot can be achieved quite easily with a few lines of script code.
I hope you will have fun!</p>
<p>The given examples will all refer to our <a href="fiberpower.html">RP Fiber Power</a> software; very similar things are possible in our resonator design software <a href="resonator.html">RP Resonator</a>, for example, or in the coating design software <a href="coating.html">RP Coating</a>.</p>
<h2 class="togglediv">Simple Plots not Affecting a System</h2>
<div>
<p>Let us begin with simpler kinds of plots, where the operation and system parameters are not changed.
As an example, consider a fiber amplifier model with our software <a href="fiberpower.html">RP Fiber Power</a> where we want to plot the distribution of pump and signal power within the fiber for a certain amplifier configuration and some set of input powers and wavelengths.
For that purpose, we can use a command like the following:</p>
<pre class="codedisplay">
f: P(signal, x) / mW,
   color = blue, width = 3, "signal power"
</pre>
<p>Generally, the &ldquo;f:&rdquo; command can be used to generate a plot based on a mathematical expression which depends on the variable <span class="eqn_il"><i>x</i></span>.
For some number of <span class="eqn_il"><i>x</i></span> values within the range of the horizontal coordinate axis, that expression is evaluated, and the results are used as <span class="eqn_il"><i>y</i></span> coordinates of the plotted curve.
For obtaining the <span class="eqn_il"><i>y</i></span> value, I have divided the obtained power by mW (a predefined constant, the value of which is 0.001), assuming that the vertical axis values are understood as milliwatts.
In our example, three additional options have been used, which modify the color and width of the curve and produce a text label, helping the user to distinguish different curves.</p>
<p>In our example case, we used the predefined function P(), having two arguments: the used &ldquo;optical channel&rdquo; and the position in the fiber, where 0 refers to the left end.
In the software documentation, one can find numerous other functions with which one can access various calculated quantities.
In many cases, the required calculation is triggered by the function call; in other cases, the calculations have already been done, and the function only retrieves their results.</p>
</div>
<h2 class="togglediv">Changing an Operation Parameter in a Plot</h2>
<div>
<p>It is quite common that one makes plots where a certain operation parameter is varied along the <span class="eqn_il"><i>x</i></span> axis.
For example, we might want to plot the signal output power as a function of the applied pump power.
In such a case, three different things have to be done for each <span class="eqn_il"><i>x</i></span> value:</p>
<ul>
<li>A system parameter (in our case, the pump power) has to be set according to the <span class="eqn_il"><i>x</i></span> value.</li>
<li>The state of the system has to be recalculated.</li>
<li>A certain output value (here: the signal output power) has to be retrieved and used as the <span class="eqn_il"><i>y</i></span> coordinate.</li>
</ul>
<p>In RP Fiber Power, we can achieve all that (and make the coordinate system) with the following commands:</p>
<pre class="codedisplay">
x: 0, 500
"pump power (mW)", @x
y: 0, 300
"signal power (mW)", @y
frame
&nbsp;
f: (set_P_in(pump, x * mW); P_out(signal)) / mW,
   color = blue, width = 3
</pre>
<p>For performing the above-mentioned tasks, a so-called <em>composite expression</em> is used with the &ldquo;f:&rdquo; command; it consists of two expressions separated by a semicolon and enclosed in parentheses.
(Instead of the parentheses, one could use &ldquo;begin&rdquo; and &ldquo;end&rdquo;.)
Some details:</p>
<ul>
<li>The first used function call modifies the input power of a certain optical channel (here: the pump channel).
The multiplication with mW converts the coordinate value into a power in fundamental units (watts).</li>
<li>The second function retrieves the output power for a certain channel.
When that is called, the system state is automatically recalculated, as the software has recognized that the system state has become invalid due to the modification of an input power.</li>
</ul>
<p>The result of the composite expression is the result of the last expression, i.e., the signal output power.</p>
<p>There are numerous other functions for modifying other operation parameters.
For example, one could modify the signal wavelength:</p>
<pre class="codedisplay">
f: (set_lambda(signal, x * nm); P_out(signal)) / mW,
   color = blue, width = 3, "signal power"
</pre>
</div>
<h2 class="togglediv">Changing a System Parameter</h2>
<div>
<p>We can use essentially the same techniques as above to obtain plots where certain system parameters are changed.
For example, we might change the length of the active fiber used in a fiber amplifier.
The plot may then be generated with the following code:</p>
<pre class="codedisplay">
f: (set_L(x); P_out(signal)) / mW,
   color = blue, width = 3, "signal power"
</pre>
</div>
<h2 class="togglediv">Restoring Values After a Plot</h2>
<div>
<p>If we do nothing more than shown above, we might encounter a problem: when the plot is finished, the varied operation or system parameter of the last point in the plot &ndash; corresponding to the highest <span class="eqn_il"><i>x</i></span> value &ndash; remains valid.
This may affect further plots, for example as parts of further diagrams.
Therefore, it is often desirable to restore the original state when a plot is finished.</p>
<p>In the previous example case, let us assume that the fiber length was originally defined by the variable L.
This means that after the plot we want to set the fiber length to that value again.
The most clear and convenient way is to use the &ldquo;finish&rdquo; option of the &ldquo;f:&rdquo; command:</p>
<pre class="codedisplay">
f: (set_L(x); P_out(signal)) / mW,
   color = blue, width = 3, "signal power",
   finish set_L(L)
</pre>
<p>One might think that instead one could work with the following, where the length is restored with a separate command:</p>
<pre class="codedisplay">
f: (set_L(x); P_out(signal)) / mW,
   color = blue, width = 3, "signal power"
call set_L(L)
</pre>
<p>That would fail, however, for a subtle reason: diagrams and contained plots etc. are not immediately generated when the corresponding commands are read, but only later on after successful reading of the whole script.
(The reasoning behind that is that you do not want to wait for possibly time-consuming plot only in order to learn thereafter that a syntax error further down in the script should have been corrected first.)
For that reason, the following would happen:</p>
<ul>
<li>The details for the plot (as defined with the &ldquo;f:&rdquo;) command are stored for later use.</li>
<li>The fiber length is set.</li>
<li>Later on, the plot is made &ndash; after rather than before setting the fiber length!</li>
</ul>
<p>That problem can be avoided by using the &ldquo;!&rdquo; command (instead of &ldquo;calc&rdquo;), which stores an expression for later evaluation when the plot is made:</p>
<pre class="codedisplay">
f: (set_L(x); P_out(signal)) / mW,
   color = blue, width = 3, "signal power"
! set_L(L)
</pre>
<p>The better solution, however, is using the &ldquo;finish&rdquo; option as shown above, because then the restoration action becomes part of the plotting command.
This makes it less likely that you will erroneously copy the plotting command for use somewhere else in the script while forgetting that the restoration action should also be copied.</p>
<p>By the way, there is also the &ldquo;init&rdquo; option which calls an expression <em>before</em> making the plot.</p>
</div>
<h2 class="togglediv">Making Multiple Plots with a Single Command</h2>
<div>
<p>It is often convenient to produce multiple plots with a single command, where a certain parameter is different for each plot.
For example, you may want to plot the signal output power of a fiber amplifier as a function of the signal wavelength, and this for different values of the pump power.
This could be done with the following code:</p>
<pre class="codedisplay">
f: (set_lambda(signal, x * nm); P_out(signal)) / mW,
   color = blue, width = 3,
   init set_P_in(pump, P),
   for P := 100 mW to 500 mW step 50 mW,
   finish set_P_in(pump, P_p_in)
! set_lambda(signal, lambda_s)
</pre>
<p>Here, I have done the restoration of the original signal wavelength with a separate &ldquo;!&rdquo; , so that it is done only once after the whole plotting rather than after each single plot (which would actually also not have caused a problem).</p>
</div>
<h2 class="togglediv">Cases Where the x Coordinate is Not an Input Value</h2>
<div>
<p>In all the discussed example cases, the <span class="eqn_il"><i>x</i></span> values were input values.
In some cases, however, you want to use some <em>calculated</em> values as <span class="eqn_il"><i>x</i></span> values.
For example, you may want to plot the signal output power of the fiber amplifier is a function of the <em>absorbed</em> pump power rather than the <em>injected</em> pump power.</p>
<p>The problem is that there is no predefined function telling the system something like &ldquo;put in as much pump power as needed to get a certain amount of pump power absorbed&rdquo;.
It is actually possible to define such a function, but there is a much simpler way to solve our problem: using a <em>parametric plot</em>.
Here, some input parameter (the injected pump power) runs through a certain range, and we get both the <span class="eqn_il"><i>x</i></span> and <span class="eqn_il"><i>y</i></span> values calculated from that parameter:</p>
<pre class="codedisplay">
k: P_in := 0 to 800 mW step 1 mW,
   { x = } (set_P_in(pump, P_in); (P_in - P_out(pump)) / mW),
   { y = } P_out(signal) / mW,
   color = blue, width = 3,
   finish set_P_in(pump, P_p_in)
</pre>
<p>The &ldquo;k:&rdquo; command for parametric plots obtains</p>
<ul>
<li class="ta_left">a variable and a range of values it must run through,</li>
<li class="ta_left">an expression for calculating the <span class="eqn_il"><i>x</i></span> coordinate value,</li>
<li class="ta_left">an expression for calculating the <span class="eqn_il"><i>y</i></span> coordinate value, and</li>
<li class="ta_left">additional options as needed.</li>
</ul>
<p>In our example, the <span class="eqn_il"><i>x</i></span> value is the injected pump power minus the residual pump power at the fiber end &ndash; this is the absorbed pump power.
(If the fiber has parasitic losses, the power absorbed by those is included.)</p>
</div>
<h2 class="togglediv">Keeping Certain Values Constant</h2>
<div>
<p>In some cases, you want to automatically have some operation parameter adjusted such that a certain condition is maintained.
For example, you may want to have as much as pump power as required for obtaining a certain signal output power.</p>
<pre class="codedisplay">
SetPumpForSignalOutput(P_s_out) := 
  zero((set_P_in(pump, P_p_in); P_out(signal) - P_s_out),
       P_p_in in [0, 1], xtol = 1 uW);
&nbsp;
P_signal_out_wanted := 10 mW
show "P_p_in: ", P_p_in := SetPumpForSignalOutput(P_signal_out_wanted):d3:"W"
</pre>
<p>You see that I have defined a function which adjusts the pump power such that the obtained signal output power minus the wanted signal output power is zero.
The &ldquo;zero&rdquo; function is a very convenient and efficient tool for numerical root finding.
As its result, it delivers the value required for achieving the set goal.</p>
<p>Once you have a function like SetPumpForSignalOutput(), you can also use it in a plot:</p>
<pre class="codedisplay">
f: (set_P_in(signal, x * mW); SetPumpForSignalOutput(P_signal_out_wanted); P_out(pump)),
   step = 30, color = red, width = 3, "residual pump power",
   finish set_P_in(signal, P_signal_in)
</pre>
<p>Here, the signal input power is very along the <span class="eqn_il"><i>x</i></span> axis.
For each value, the pump power is calculated such that the required signal output power is achieved.
What is plotted is the residual pump power, i.e., the output power of the pump channel.</p>
</div>
<h2 class="togglediv">Final Remarks</h2>
<div>
<p>You have seen that it is not too difficult to generate all sorts of plots with a bit of script code.
Initially, you may find it a little tricky to get this code developed.
However, there are various ways to get the required solution:</p>
<ul>
<li>The script language is well documented in the manual and the online help system.
Admittedly, it may take you too much time to construct a solution that way.</li>
<li>Our software is delivered with plenty of demo files, where such techniques are applied.
Often, just by reading that code you will understand straightaway how it works.
Then you can copy pieces of code from there and adapt them to your needs.</li>
<li>In RP Fiber Power, you can start using the interactive forms rather than writing script code.
When you execute the calculations, the software will generate a script based on your form inputs.
You can take that script as a starting point for further refinements.
So you get most of your script written automatically and only at some specialties.</li>
<li>Of course, you can make use of the technical support.
Tell me what you want to plot, and I will insert the required code into the script which you sent me, or send you some isolated snippets of code which you can paste into your script.</li>
</ul>
<p>Also be aware that such a script language gives you an enormous flexibility.
With it, you can do even a lot of things which I (the software developer) never had in mind.
Therefore, it is absolutely worthwhile to spend a little time for learning how that works.</p>
<p>See also the <a href="software_news_2015_10_31.html">article of 2015-10-31</a>, which discusses our expression engine in more detail.
Also, the <a href="software_news_2015_10_31.html">article of 2013-10-02</a> gives you some internal insight; it tells you how expression are stored and handled internally, if you are curious how such things work.</p>
</div>
<p style="font-size:85%; margin-bottom:10px;">This article is a posting of the <a href="software_news.html">RP Photonics Software News</a>, authored by <a href="paschotta.html">Dr. Rüdiger Paschotta</a>.
You may link to this page, because its location is permanent.</p>
<p style="font-size:85%; margin-bottom:15px;">Note that you can also receive the articles in the form of a <a href="newsletters.html">newsletter</a> or with an <a href="software_news.rss">RSS feed</a>.</p>
<p style="margin-top:15px;">If you like this article, share it with your friends and colleagues, e.g. via social media:</p>
<div class="shariff" data-services="[&quot;linkedin&quot;,&quot;facebook&quot;,&quot;twitter&quot;,&quot;googleplus&quot;]" data-theme="standard" data-lang="en" data-orientation="horizontal"></div>
<script type="text/javascript" src="shariff/shariff.min.js"></script>
</main>
<div id="up_arrow">
<a href="javascript:scroll(0,0)"><img src="img/up.png" width="32" height="20" alt="arrow"></a>
</div>

</div>
<footer id="copyrightbox">
<span class="copyright">&copy; <a href="paschotta.html">Dr. Rüdiger Paschotta</a>, RP Photonics Consulting GmbH, also at <a href="https://profiles.google.com/109063044353551581702?rel=author">Google+</a>&nbsp;&nbsp;&nbsp;&nbsp; All rights reserved worldwide</span>
</footer>
</body>

<!-- Mirrored from www.rp-photonics.com/software_news_2015_10_01.html by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 12 Feb 2019 03:10:11 GMT -->
</html>
