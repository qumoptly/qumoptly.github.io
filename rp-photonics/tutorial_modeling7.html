<!DOCTYPE html>
<html lang="en">

<!-- Mirrored from www.rp-photonics.com/tutorial_modeling7.html by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 12 Feb 2019 03:31:40 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
<meta http-equiv="content-type" content="text/html; charset=utf-8">
<title>Tutorial &ldquo;Modeling of Fiber Amplifiers and Lasers&rdquo;, Part 7: Ultrashort pulses, field envelope amplitudes, temporal grid, resolution, Fourier techniques, propagation equations, software</title>
<link rel="stylesheet" type="text/css" href="styles.css">
<link rel="stylesheet" type="text/css" href="shariff/shariff.complete.css">
<link rel="shortcut icon" href="favicon.ico" type="image/x-icon">
<link rel="alternate" type="application/rss+xml" title="The Photonics Spotlight" href="spotlight.rss">
<link rel="alternate" type="application/rss+xml" title="The RP Photonics Software News" href="software_news.rss">
<link rel="alternate" type="application/rss+xml" title="New encyclopedia articles" href="new_articles.rss">
<meta name="date" content="2018-10-28">
<meta name="description" content="Tutorial on modeling of fiber amplifiers and lasers. This part explains how ultrashort pulses can be handled in a numerical model. It discusses the numerical representation of pulses, the propagation equations and Fourier algorithms for solving them.">
<meta name="copyright" content="2019 RP Photonics Consulting GmbH">
<meta name="author" content="Dr. R&uuml;diger Paschotta">
<meta name="publisher" content="RP Photonics Consulting GmbH">
<meta name="referrer" content="always">
<meta name="geo.position" content="48.018; 8.540">
<meta name="geo.placename" content="Bad D&uuml;rrheim">
<meta name="geo.region" content="DE">
<meta name="distribution" content="global">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="keywords" content="tutorial, modeling, fiber amplifiers, fiber lasers, ultrashort pulses, field envelope amplitudes, temporal grid, resolution, Fourier techniques, propagation equations, software">
<script type="text/javascript" src="jquery-3.3.1.min.js"></script>
<script type="text/javascript" src="general.js"></script>
<script type="text/javascript">
page="tutorial_modeling7.html"; cat="C"; shownbanner=""; ref="pulse_propagation_modeling.html"; ts = new Date().toJSON().substring(0, 19);
$(document).ready(function($){ $.get("log.html",{cat:cat,page:page,ref:ref,shownbanner:shownbanner,ts:ts}); })
</script>
</head>
<body>
<div id="logohead">
<div class="areadiv"><table id="areatable"><tr><td>
<div class="areadiv"><table class="areasubtable">
<tr><td colspan="2" class="basicarea"><a href="marketing.html">RP Photonics Marketing</a></td></tr>
<tr><td><a href="encyclopedia.html">Encyclopedia</a></td>
<td><a href="buyersguide.html">Buyer's Guide</a></td></tr>
</table></div>
</td>
<td>
<div class="areadiv"><table class="areasubtable">
<tr><td colspan="2" class="basicarea"><a href="consulting.html">RP Services and Tools</a></td></tr>
<tr><td class="selected"><a href="consulting.html">Consulting</a></td>
<td><a href="software.html">Software</a></td></tr>
</table></div>
</td></tr></table></div>
<p><span id="title1">RP Photonics</span></p>
<p><span id="title2">Consulting</span> <span id="slogan">&hellip; competent technical support for your business!!</span></p>
</div>
<nav id="con">
<div id="navitems">
<a id="Home" href="consulting.html">Home</a>
<a id="Company" href="company.html">Company</a>
<a id="Topics" href="topics.html">Topics</a>
<a id="Services" href="services.html">Services</a>
<a id="Software" href="software_con.html">Software</a>
<a id="Publications" href="encyc.html" class="sel">Publications</a>
<a id="Publications_Encyclopedia" href="encyc.html" class="sub">Encyclopedia</a>
<a id="Publications_FG_lasers" href="fg_lasers.html" class="sub">FG to Lasers</a>
<a id="Publications_FG_laser_pulses" href="fg_laser_pulses.html" class="sub">FG Laser Pulses</a>
<a id="Publications_FG_fiber_optics" href="fg_fiber_optics.html" class="sub">FG Fiber Optics</a>
<a id="Publications_Tutorials" href="tutorials.html" class="sub sel">Tutorials</a>
<a id="Publications_Scientific" href="scipubs.html" class="sub">Scientific</a>
<a id="Publications_Articles" href="journal_articles.html" class="sub">Trade journals</a>
<a id="Publications_Downloads" href="downloads.html" class="sub">Downloads</a>
<a id="News" href="news.html">News</a>
<a id="Anniversary" href="anniversary10.html">Anniversary</a>
<a id="Website" href="website.html">Website</a>
<a id="Nletters" href="newsletters.html">Newsletters</a>
<a id="Contact" href="contact.html">Contact</a>
</div>
<div id="newsbox">
<!-- Our bestseller: the simulation software<br><a href="/fiberpower.html?s=news">RP Fiber Power</a> -->
Read our <a href="tutorialsaee8.html?s=news">fiber optics tutorials</a> and get our <a href="newslettersaee8.html?s=news">newsletters</a> on <a href="spotlightaee8.html?s=news">technology</a> and <a href="software_newsaee8.html?s=news">software</a>!
</div>
</nav>
<div id="main">
<main>
<h1>Modeling of Fiber Amplifiers and Lasers</h1>
<p>This is part 7 of a <a href="tutorial_modeling.html">tutorial on modeling of fiber amplifiers and lasers</a> from <a href="paschotta.html">Dr. Paschotta</a>. The tutorial has the following parts:</p>
<div class="article_parts"><span style='float:left; margin:0 25px 5px 10px; font-size:60px; color:#888; font-weight:bold; line-height:100%;'>7</span>
<p>1:&nbsp;<a href="tutorial_modeling1.html">Introduction</a>, 2:&nbsp;<a href="tutorial_modeling2.html">Optical channels</a>, 3:&nbsp;<a href="tutorial_modeling3.html">Power propagation or field propagation</a>, 4:&nbsp;<a href="tutorial_modeling4.html">The laser-active ions</a>, 5:&nbsp;<a href="tutorial_modeling5.html">Continuous-wave operation of amplifiers and lasers</a>, 6:&nbsp;<a href="tutorial_modeling6.html">Amplifying and generating short pulses</a>, 7:&nbsp;<span style="text-decoration:underline;">Ultrashort pulses</span>, 8:&nbsp;<a href="tutorial_modeling8.html">Using home-made software or a commercial product?</a>
</p>
</div>
<h2 class="togglediv">Part 7: Ultrashort Pulses</h2>
<div>
<p>For pulse durations in the picosecond or even femtosecond regime, additional physical effects come into play.
One of these is <a href="chromatic_dispersion.html" title="chromatic dispersion: the frequency dependence of the phase velocity in a transparent medium">chromatic dispersion</a>, i.e., the wavelength dependence of the <a href="effective_refractive_index.html" title="effective refractive index: a number quantifying the phase delay per unit length in a waveguide, relative to the phase delay in vacuum">effective refractive index</a> of the fiber.
(Note that we normally need to take into account <a href="waveguide_dispersion.html" title="waveguide dispersion: chromatic dispersion arising from waveguiding effects">waveguide dispersion</a>, except for some <a href="large_mode_area_fibers.html" title="large mode area fibers: optical fibers with relatively large mode areas and a single transverse mode or only a few modes">large mode area fibers</a>.)
Also, fiber <a href="nonlinearities.html" title="nonlinearities: optical phenomena involving a nonlinear response to a driving light field">nonlinearities</a> can have strong effects.
One may have to consider not only the <a href="kerr_effect.html" title="Kerr effect: a nonlinear interaction of light in a medium with an instantaneous response, related to the nonlinear electronic polarization">Kerr nonlinearity</a>, but also the delayed nonlinear response which results in stimulated <a href="raman_scattering.html" title="Raman scattering: a nonlinear scattering process involving optical phonons">Raman scattering</a>.
These aspects are discussed in <a href="tutorial_fiber_amplifiers8.html">part 8</a> of our <a href="tutorial_fiber_amplifiers.html">fiber amplifier tutorial</a>.</p>
<p>The combination of numerical beam propagation with ultrashort pulses would be quite demanding in terms of computation time and memory.
Fortunately, in most cases one will deal with situations where the transverse spatial effects are not of interest; we can assume fixed transverse intensity profiles (see <a href="tutorial_modeling3.html">section 3</a>).</p>
<h3 class="togglediv">How to Represent Ultrashort Pulses</h3>
<div>
<aside class="callout blue">An ultrashort pulse needs to be represented by an array of complex amplitudes in the time domain or frequency domain.</aside>
<p>For each <span class="eqn_il"><i>z</i></span> position in the fiber, we now need to consider the time-dependent complex field amplitude.
Some details:</p>
<ul>
<li>One usually uses field envelope amplitudes <span class="eqn_il"><i>A</i>(<i>t</i>)</span>.
The electric field strength is proportional to <span class="eqn_il">Re(<i>A</i>(<i>t</i>)&thinsp;exp(&minus;<i>i&thinsp;<span class="greek">&omega;</span></i><sub>0</sub>&thinsp;<i>t</i>))</span> where <span class="eqn_il"><span class="greek">&omega;</span><sub>0</sub></span> is the mean angular frequency.
The complex field amplitudes may be normalized such that their squared modulus corresponds to the optical powers.</li>
<li>The amplitudes need to be stored within a temporal range which is sufficiently large to span e.g. somewhat more than the considered optical pulse.
Numerically, one needs an array of amplitudes with a temporal spacing which is fine enough to properly sample the pulses at all times.
Normally, the number of components of that field should be a power of 2 in order to facilitate the use of Fourier techniques (see below).</li>
<li>One usually uses a &ldquo;moving time frame&rdquo;, where an injected pulse remains centered around <span class="eqn_il"><i>t</i>&thinsp;=&thinsp;0</span> as long as nonlinear and dispersive effects do not shift the pulse maximum.</li>
</ul>
<p>The appropriate choice of parameters for the temporal grid (width of time range, temporal resolution, number of points) is not always obvious.
During the simulations, one may have to monitor whether the chosen grid parameters are sufficient for a reasonable numerical accuracy.
For calculations on mode-locked lasers, 256 grid points are sometimes already sufficient, whereas simulations involving strongly chirp pulses or even <a href="supercontinuum_generation.html" title="supercontinuum generation: a nonlinear process for strong spectral broadening of light">supercontinuum generation</a> require far more.</p>
</div>
<h3 class="togglediv">Propagation Equations</h3>
<div>
<p>The required propagation equations can become substantially more complicated than for longer pulses.
As an example, the following equation for the complex amplitude <span class="eqn_il"><i>A</i>(<i>z</i>,<i>t</i>)</span> describes the propagation of a single optical channel under the effects of amplifier gain, background losses, chromatic dispersion of second and third order, and nonlinear effects including a delayed nonlinear response (<a href="kerr_effect.html" title="Kerr effect: a nonlinear interaction of light in a medium with an instantaneous response, related to the nonlinear electronic polarization">Kerr effect</a> and stimulated <a href="raman_scattering.html" title="Raman scattering: a nonlinear scattering process involving optical phonons">Raman scattering</a>).
The nonlinear response function <span class="eqn_il"><i>R</i>(<span class="greek">&tau;</span>)</span> is related to the Fourier-transformed Raman gain spectrum.</p>
<div class="eqn"><img src="eqn/dadz.gif" width="346" height="104" alt="propagation equation for ultrashort pulses"></div>
<p>When multiple optical channels propagate together, there are additional nonlinear coupling terms, making things even more complicated.</p>
</div>
<h3 class="togglediv">Solving the Equations with Fourier Methods</h3>
<div>
<p>Effects like chromatic dispersion and wavelength-dependent gain and losses are usually treated in the frequency domain.
This means that one has to apply a Fourier transform algorithm (usually a Fast Fourier Transform = FFT) to the above-mentioned temporal trace in order to obtain an array of complex amplitudes in the frequency domain.
There, one can easily apply frequency-dependent phase changes and/or amplitude changes.
(For example, the second time derivative corresponding to second-order dispersion corresponds to a simple multiplication factor <span class="eqn_il">&minus;<span class="greek">&omega;</span><sup>2</sup></span> in the frequency domain.)
With a reverse Fourier transform, one gets back to the time domain.</p>
<p>One usually uses a kind of <b>split-step Fourier algorithm</b>.
Efficient computations often require an automatic step size control, because a much smaller numerical step size may be required at locations in the fiber where a pulse acquires a high peak power due to amplification and/or dispersive compression.
Correctly handling the terms for a delayed nonlinear response (Raman scattering) is particularly difficult; additional Fourier transforms are needed for an efficient solution.</p>
</div>
<h3 class="togglediv">Software Helps</h3>
<div>
<aside class="callout blue">Solving such equations is rather difficult, but just using a well-designed simulation software is not a big deal!</aside>
<p>Even though the technical details for ultrashort pulse propagation are rather complicated, a powerful simulation software makes it relatively simple for the user to calculate and simulate such things.
The software must be provided with suitable fiber data concerning dispersion and nonlinearities, and also the user must usually determine the numerical parameters for representing the pulses &ndash; for example, the width of the temporal traces, the number of sampling points and the center wavelength.
These together determine the frequency (or wavelength) range which can be numerically represented.</p>
<p>A good software tool cannot only do such calculations reliably and quickly, but also conveniently display the calculated results.
As an example, Figure&nbsp;5 shows the interactive pulse display window of the <a href="fiberpower.html"><b>RP Fiber Power</b></a> software, which makes it easy to inspect pulses at any point within the fiber.
However, interactive window should not be the only way to access the data; one should also have scripting capabilities for efficient control and data processing.</p>
<figure>
<img src="img/pulse_window.png" alt="interactive pulse display window">
<figcaption><span class="start">Figure&nbsp;1:</span> 
The software <a href="fiberpower.html"><b>RP Fiber Power</b></a> has an interactive window for displaying a pulse in the time domain (upper graph) and frequency domain (lower graph). With the control at the bottom, one can get the pulse at any position in the fiber. The small vertical lines at the top edges of the two diagrams indicate the numerical grid.
</figcaption>
</figure>
</div>
<h3 class="togglediv">Requirements for Some Example Cases</h3>
<div>
<p>Different simulation scenarios can be relevant for practical work:</p>
<ul>
<li>Simple cases require only single-pass propagation, e.g. of signal pulses through a fiber amplifier.
One may then want to inspect the resulting pulses not only at the output end, but at any location within the fiber.</li>
<li>One may also have to deal with a sequence of different fibers and possibly other optical elements influencing the pulses.
For example, input pulses may be sent through a pulse stretcher, then through the active fiber and finally through a pulse compressor in order to exploit the principle of <a href="chirped_pulse_amplification.html" title="chirped-pulse amplification: a technique for amplifying pulses to very high optical intensities while avoiding excessive nonlinear pulse distortions or optical damage">chirped-pulse amplification</a>.
It is then highly desirable that the software is sufficiently flexible e.g. to allow the generation of diagrams where any parameters of the resulting pulses are plotted as functions of any parameters of the system.</li>
<li>When studying <a href="mode_locked_fiber_lasers.html" title="mode-locked fiber lasers: ultrafast fiber lasers which are actively or passively mode-locked for generating ultrashort pulses">mode-locked fiber lasers</a>, one may need not only to investigate a single round-trip in the laser resonator (which can comprise multiple optical elements including active and passive fibers, modulators, optical filters, <a href="saturable_absorbers.html" title="saturable absorbers: light absorbers with a degree of absorption which is reduced at high optical intensities">saturable absorbers</a>, etc.), but rather the evolution in multiple round-trips.
One may even want to automatically propagate the pulse until it reaches the steady state (if that exists), and do this for a certain range of parameters.
(Of course, the software should be able to automatically determine when the steady state has been approximately reached.)
One may, for example, plot the achieved pulse duration (possibly after an automatically adjusted pulse compressor) as a function of the amount of chromatic dispersion in the laser resonator.</li>
</ul>
<p>A simple simulation software may offer single-pass simulations with all relevant details, but may not be usable for more sophisticated studies e.g. on mode-locked lasers.
For example, if one would always have to manually transfer a pulse from one fiber to the next one, or manually perform subsequent round-trips until pulse parameters do not change significantly any more, the procedure could simply become far too tedious.
Powerful scripting support for automating such procedures, as offered by <a href="fiberpower.html"><b>RP Fiber Power</b></a>, can be indispensable.</p>
<p>We have published a <a href="fiberpower_ml_fl.html">case study for a mode-locked fiber laser</a> which serves as a nice example.
It is an all-normal-dispersion laser, which exhibits relatively complicated pulse formation dynamics.
Figure&nbsp;2 is taken from that case study; it shows how the optical spectrum of the circulating pulse converges to the steady state, leading to a nearly rectangular spectral shape.</p>
<figure>
<img src="img/fiberpower_ml_fl2.png" alt="pulses in frequency domain">
<figcaption><span class="start">Figure&nbsp;2:</span> 
Pulse spectra in an all-normal-dispersion fiber laser for the first 100 round trips.
</figcaption>
</figure>
<p>Figure&nbsp;3 shows how the pulse parameters approach the steady state.
These parameters are always taken for the pulse as it occurs directly before it hits the output coupler.
One could now change various parameters of the laser resonator in order to check how these affect the convergence to the steady state.</p>
<figure>
<img src="img/fiberpower_ml_fl4.png" alt="evolution of pulse parameters">
<figcaption><span class="start">Figure&nbsp;3:</span> 
Evolution of the pulse parameters during the first 100 round trips.
</figcaption>
</figure>
<p>Figure&nbsp;4 shows how the pulse parameters vary within the resonator (in the steady state).
One sees that when going from left to right, the pulse duration rises substantially, while the pulse bandwidth rises only slightly.
Both parameters are reset by a bandpass filter in the resonator.</p>
<figure>
<img src="img/fiberpower_ml_fl5.png" alt="evolution of pulse parameters">
<figcaption><span class="start">Figure&nbsp;4:</span> 
Pulse parameters within the passive and active fibers. The active part is shown in red.
</figcaption>
</figure>
</div>
<h3 class="togglediv">Flexibility is Crucial</h3>
<div>
<p>From such examples one can see that the high flexibility of a well made simulation tool is not just nice, but rather is essential for real work.
It is not sufficient to be able to simulate a round trip in the laser resonator; one also needs to generate various kinds of plots in order to gain a clear understanding of what is happening in such lasers.
Also, one needs a flexible interactive tool for inspecting pulses anywhere in the resonator, particularly if one has not yet found suitable parameters for stable pulse formation.
Once the crucial factors for pulse stability have been identified, one could also make a color plot, for example, which indicates the pulse stability as a function of two different parameters.</p>
<p>Note that the powerful <a href="software_script_language.html"><b>script language</b></a>, as our software offers it, gives you the maximum degree of flexibility.
Even if the designer of a software without that feature would have predefined a huge number of different diagrams, you may well find that what you need in practice is outside that selection.
Therefore, you want to be able to control any details of diagrams, sequences of fibers and other optical elements, optimization strategies, etc.</p>
<p>Go to <a href="tutorial_modeling8.html">Part 8: Using home-made software or a commercial product?</a>, or back to the <a href="tutorial_modeling.html">start page</a>.</p>
</div>
</div>
<hr>
<footer id="feedbackbox">
<h2>How do you rate this article?</h2>
<p><a id="showfeedbackformlink" href=".html" onclick="return showfeedbackform()">Click here to send us your feedback!</a></p>
<noscript><p>(As Javascript is not activated, you don't need to click.)</p></noscript>
<script type="text/javascript">
function showfeedbackform() {
  $("div#feedbackstuff").css("display","block");
  $("a#showfeedbackformlink").css("display","none");
  return false;
  };
$(document).ready(function() {
  $("div#feedbackstuff").css("display","none");
  });
</script>
<div id="feedbackstuff">
<form name="articlefeedback" action="https://www.rp-photonics.com/articlefeedback.html" method="post" onsubmit="return(check_form())" title="Feedback for encyclopedia article">
<table style="font-size:11px;">
<tr>
<td style="width:150px;">Your general impression:</td>
<td>
<input type="radio" name="generalquality" value="don't know" checked="checked">don't know
<input type="radio" name="generalquality" value="poor">poor
<input type="radio" name="generalquality" value="satisfactory">satisfactory
<input type="radio" name="generalquality" value="good">good
<input type="radio" name="generalquality" value="excellent">excellent
</td>
</tr>
<tr id="trtechnical">
<td>Technical quality:</td>
<td>
<input type="radio" name="technicalquality" value="don't know" checked="checked">don't know
<input type="radio" name="technicalquality" value="poor">poor
<input type="radio" name="technicalquality" value="satisfactory">satisfactory
<input type="radio" name="technicalquality" value="good">good
<input type="radio" name="technicalquality" value="excellent">excellent
</td>
</tr>
<tr id="truseful">
<td>Usefulness:</td>
<td>
<input type="radio" name="usefulness" value="don't know" checked="checked">don't know
<input type="radio" name="usefulness" value="poor">poor
<input type="radio" name="usefulness" value="satisfactory">satisfactory
<input type="radio" name="usefulness" value="good">good
<input type="radio" name="usefulness" value="excellent">excellent
</td>
</tr>
<tr id="trreadable">
<td>Readability:</td>
<td>
<input type="radio" name="readability" value="don't know" checked="checked">don't know
<input type="radio" name="readability" value="poor">poor
<input type="radio" name="readability" value="satisfactory">satisfactory
<input type="radio" name="readability" value="good">good
<input type="radio" name="readability" value="excellent">excellent
</td>
</tr>
<tr id="trcomments">
<td>Comments:</td>
<td><textarea name="comments" rows="5" cols="45"></textarea><p style="font-size:11px;">Found any errors? Suggestions for improvements? Do you know a better web page on this topic?</p></td>
</tr>
<tr><td>Spam protection:</td><td><input type="text" name="spam" size="5"> (enter the value of 5 + 8 in this field!)<input type="hidden" name="page" value="<?php echo $page_fname; ?>"></td></tr>
</table>
<p>If you want a response, you may leave your e-mail address in the comments field, or directly <a href="contact.html">send an e-mail</a>.</p>
<p>If you enter any personal data, this implies that you agree with storing it; we will use it only for the purpose of improving our website and possibly giving you a response; see also our <a href="privacy.html">declaration of data privacy</a>.</p>
<p>If you like our website, you may also want to get our <a href="newsletters.html">newsletters</a>!</p>
<div style="margin-top:6px;"><input type="submit" name="form_submitted" value="Submit" /></div>
</form>
</div>
<script type="text/javascript">
function check_form() {
 with (document.articlefeedback) {
 if (generalquality[0].checked && technicalquality[0].checked && usefulness[0].checked && readability[0].checked)
   { alert("Error: the input ''don't know'' is no rating!");
     return false; }
  else if ((generalquality[1].checked || technicalquality[1].checked) && (comments.value == ""))
   { alert("Please explain in the comments field the reason for your low rating and submit the rating again!");
     return false; }
  else { return true; }
 }
}
</script>
</footer>
</main>
<div id="up_arrow">
<a href="javascript:scroll(0,0)"><img src="img/up.png" width="32" height="20" alt="arrow"></a>
</div>
</div>
<footer id="copyrightbox">
<span class="copyright">&copy; <a href="paschotta.html">Dr. RÃ¼diger Paschotta</a>, RP Photonics Consulting GmbH, also at <a href="https://profiles.google.com/109063044353551581702?rel=author">Google+</a>&nbsp;&nbsp;&nbsp;&nbsp; All rights reserved worldwide &nbsp;&nbsp;&nbsp;&nbsp; <a href="contact.html">Contact and legal info</a></span>
</footer>
</body>

<!-- Mirrored from www.rp-photonics.com/tutorial_modeling7.html by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 12 Feb 2019 03:31:40 GMT -->
</html>
